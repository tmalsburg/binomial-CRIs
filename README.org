#+PROPERTY: header-args:R :session *R*

* R functions for calculating and plotting binomial credible intervals

Note: When plotting to PDF, use the function ~cairo_pdf()~ instead of ~pdf()~ to get greek characters in the results.

50% credible intervals after seeing 6 successes out of 9 trials, with flat prior:

#+BEGIN_SRC R :exports both :results value output
source("binomial_credible_intervals.R")

binomial.hpdi(n.successes=6, n.trials=9, prior.alpha=1, prior.beta=1, prob=0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5643603 0.7593849 

#+BEGIN_SRC R :exports both :results output graphics :file hpdi1.png
plot.binomial.hpdi(6, 9, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/hpdi1.png]]

#+BEGIN_SRC R :exports both :results value output
binomial.pi(6, 9, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5423038 0.7391494

#+BEGIN_SRC R :exports both :results output graphics :file pi1.png
plot.binomial.pi(6, 9, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/pi1.png]]

50% credible intervals after seeing 6 successes out of 9 trials, with prior assuming one earlier success and one earlier failure:

#+BEGIN_SRC R :exports both :results value output
binomial.hpdi(6, 9, 2, 2, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5419229 0.7242251

#+BEGIN_SRC R :exports both :results output graphics :file hpdi2.png
plot.binomial.hpdi(6, 9, 2, 2, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/hpdi2.png]]

#+BEGIN_SRC R :exports both :results value output
binomial.pi(6, 9, 2, 2, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5269063 0.7101529

#+BEGIN_SRC R :exports both :results output graphics :file pi2.png
plot.binomial.pi(6, 9, 2, 2, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/pi2.png]]

50% credible intervals after seeing 7 successes our of 11 trials (equivalent to 6/9 with prior alpha=2, beta=2):

#+BEGIN_SRC R :exports both :results value output
binomial.hpdi(7, 11, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5419229 0.7242251

#+BEGIN_SRC R :exports both :results output graphics :file hpdi3.png
plot.binomial.hpdi(7, 11, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/hpdi3.png]]

#+BEGIN_SRC R :exports both :results value output
binomial.pi(7, 11, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5269063 0.7101529

#+BEGIN_SRC R :exports both :results output graphics :file pi3.png
plot.binomial.pi(7, 11, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/pi3.png]]

50% credible intervals after seeing 1 successes out of 2 trials, with
flat prior:

#+BEGIN_SRC R :exports both :results value output
binomial.hpdi(1, 1, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.7070744 0.9999771

#+BEGIN_SRC R :exports both :results output graphics :file hpdi4.png
plot.binomial.hpdi(1, 1, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/hpdi4.png]]

#+BEGIN_SRC R :exports both :results value output
binomial.pi(1, 1, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
:      |0.5      0.5| 
: 0.5000000 0.8660254

#+BEGIN_SRC R :exports both :results output graphics :file pi4.png
plot.binomial.pi(1, 1, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
[[https://gist.githubusercontent.com/tmalsburg/202132d78467b1982e45295f0141492c/raw/10f7efccdf79f5ef905afdba5462312122a6e12f/pi4.png]]

Probability of parameter being larger than 0.5 after seeing 6 successes out of 9 trials with flat prior:

#+BEGIN_SRC R :exports both :results value output
binomial.pgt(6, 9, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
: [1] 0.828125

Probability of parameter being larger than 0.5 after seeing 6 successes out of 9 trials with prior assuming one earlier success and one earlier failure:

#+BEGIN_SRC R :exports both :results value output
binomial.pgt(6, 9, 2, 2, 0.5)
#+END_SRC

#+RESULTS:
: [1] 0.8061523

Probability of parameter being larger than 0.5 after seeing 7 successes our of 11 trials (equivalent to 6/9 with prior alpha=2, beta=2):

#+BEGIN_SRC R :exports both :results value output
binomial.pgt(7, 11, 1, 1, 0.5)
#+END_SRC

#+RESULTS:
: [1] 0.8061523
